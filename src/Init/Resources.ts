import { Constants } from 'src/AutoGenerated/Constants'
import { Kitty } from 'src/Game/Entities/Kitty/Kitty'
import { CurrentGameMode } from 'src/Gamemodes/CurrentGameMode'
import { GameMode } from 'src/Gamemodes/GameModeEnum'
import { Globals } from 'src/Global/Globals'

export class Resources {
    private static StartingGold = 100
    public static SaveExperience = 80
    public static SaveGold = 30
    public static SaveStreakMultiplier = 0.1
    public static SafezoneExperience = 100
    public static SafezoneGold = 20
    private static EndRoundBonusGold = 150 + 50 * Globals.ROUND
    private static EndRoundBonusXP = 550 * Globals.ROUND

    public static Initialize = () => {
        Resources.SetResourcesForGamemode()
        Resources.AdjustStartingGold()
    }

    public static BonusResources = () => {
        Resources.EndRoundBonusXP = 750 * Globals.ROUND
        Resources.EndRoundBonusGold = 150 + 50 * Globals.ROUND
        for (const player of Globals.ALL_PLAYERS) player.addGold(Resources.EndRoundBonusGold) // May or may not work.. We'll see.
        for (const [_, kitty] of Globals.ALL_KITTIES) kitty.Unit.experience += Resources.EndRoundBonusXP
    }

    public static StartingItems = (kitty: Kitty) => {
        const unit = kitty.Unit
        unit.addItemById(Constants.ITEM_ADRENALINE_POTION)
    }

    public static SaveGoldBonus = (streak: number) => {
        return Resources.SaveGold + Resources.SaveGold * (Resources.SaveStreakMultiplier * streak)
    }

    private static AdjustStartingGold = () => {
        for (const player of Globals.ALL_PLAYERS) {
            player.addGold(Resources.StartingGold)
        }
    }

    private static SetResourcesForGamemode = () => {
        if (CurrentGameMode.active === GameMode.Standard) Resources.StandardResources()
        else if (CurrentGameMode.active === GameMode.SoloTournament) Resources.SoloResources()
        else if (CurrentGameMode.active === GameMode.TeamTournament) Resources.TeamResources()
    }

    private static StandardResources = () => {
        Resources.StartingGold = 200
        Resources.SaveExperience = 80
        Resources.SaveGold = 25
    }

    private static SoloResources = () => {
        Resources.SaveExperience = 0
        Resources.SaveGold = 0
        Resources.EndRoundBonusXP = 0
    }

    private static TeamResources = () => {
        Resources.SaveExperience = 15
        Resources.SaveGold = 5
        Resources.EndRoundBonusXP = 0
    }
}
